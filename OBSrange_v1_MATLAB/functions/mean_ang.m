function [ mu ] = mean_ang( theta)
% [ mu ] = mean_ang( theta )
%   Calculates circular mean of angles in radians - i.e. deals with
%   wraparound. Theta can be a vector or a matrix, means will be calculated
%   column-wise
% Z. Eilon 2011

if isrow(theta)
    theta = theta'; % flip if needed
end

n = size(theta,1);
m = size(theta,2);
mu   = zeros(1,m);

for im = 1:m
C=sum(cos(theta(:,im)));
S=sum(sin(theta(:,im)));
if C==0; error('angles sum to nothing'); end
if S==0; mu(im)=0; end
% fprintf('sample mean resultant length, mrlR, is %.3f \n',mrlR);
if S>0 && C>0
    mu(im)=atan(S/C); % in radians
elseif S<0 && C>0
    mu(im)=atan(S/C) + 2*pi; % in radians
elseif C<0
    mu(im)=atan(S/C)+pi; % in radians
end
end
end

